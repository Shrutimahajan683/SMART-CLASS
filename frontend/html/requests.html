<!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
---- Include the above in your HEAD tag -------- -->

<!DOCTYPE html>
<html>

<head>
    <title>Login Page</title>
    <!--Made with love by Mutiullah Samim -->

    <!--Bootsrap 4 CDN-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!--Fontawesome CDN-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
        integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!--Custom styles-->
    <link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>
    <ul>
        <form action="/logout.html">
            <input type="submit" class="logout" value="Logout" />
        </form>
    </ul>
    <h1 class="substyle" id="substyle">All requests</h1>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
    <div class="justify-content-center" id="requests">
    </div>
</body>
<script>
  if(sessionStorage.getItem("role")!="teacher")
       window.history.back()
    const token=sessionStorage.getItem("token");
const sclass=sessionStorage.getItem("identity");
function accept(time,date){
    const capacity=document.querySelector("#capacity").value;
    fetch(`http://localhost:3000/signin/acceptclassdata`, {
        method: "POST",
        body: JSON.stringify({
          token,
          sclass,
          time,
          date,
          capacity
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
            if(response.Status==true)
            window.location.href = "/classes.html";
});
}
function decline(time,date){
    const token=sessionStorage.getItem("token");
    fetch(`http://localhost:3000/signin/declineclassdata`, {
        method: "POST",
        body: JSON.stringify({
          token,
          sclass,
          time,
          date
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
            if(response.Status==true)
            window.location.href = "/classes.html";
});
}
 fetch(`http://localhost:3000/signin/classdata`, {
        method: "POST",
        body: JSON.stringify({
          token,
          sclass
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
          if(response.Status==true)
          {
            let htmlCode = ``;
            const requests=response.data;
            if(requests.length==0)
            {
              document.querySelector("#substyle").innerHTML="NO REQUESTS"
             let  htmlCode =
        `
        <div class="card1 empty" style="width: 18rem;">
            <img class="card-img-top img-fluid thumbnailImage" src="/img/empty.png" alt="">
        </div>
  `;
  const container=document.querySelector("#requests")
            container.innerHTML=htmlCode;
            }
            else{
              requests.forEach(function(request) {
              let timeconverted=request.time;
              let s='AM';
              let t1=Number(timeconverted[0]);
              let t2=Number(timeconverted[1]);
              let total=t1*10+t2;
              if(total>12)
              {
                s='PM';
                total=(total)%12;
              }
              htmlCode =
                htmlCode +
                `
                <div class="row con">
                <h6 class="rcap">Enter Capacity</h6>
                <input type="number" class="rin" id="capacity" value=100></input>
                <h6 class="rdate">Date: ${request.to_char}</h6>
                <h6 class="rtime">Time: ${total}:00 ${s}</h6>
                <h6 class="rcount">Count-${request.count}</h6>
                <button type="button" class="racc" onclick='accept("${request.time}","${request.to_char}")'>accept<button>
                <button type="button" onclick='decline("${request.time}","${request.to_char}")'>decline<button>
                </div>
              `;
            });
            
            const container=document.querySelector("#requests")
            container.innerHTML=htmlCode;
            
          }
            }
            
});

</script>

</html>
<!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
---- Include the above in your HEAD tag -------- -->

<!DOCTYPE html>
<html>

<head>
  <title>Home Page</title>
  <!--Made with love by Mutiullah Samim -->

  <!--Bootsrap 4 CDN-->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <!--Fontawesome CDN-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
    integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

  <!--Custom styles-->
  <link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>
  <ul>
    <form action="/logout.html">
      <input type="submit" class="logout" value="Logout" />
    </form>
  </ul>
  <h1 class="add">Add New Topic</h1>
  <div class="topic">
   <div class="row">
   <h6 class="ttitle">Title:  </h6>
   <input type="text" class="ititle" id="title">
   </div>
   <div class="row">
    <h6 class="tdesc">Description:</h6>
    <input type="text" class="idesc" id="description">
    </div>
    <button type="button" onclick="call()" class="tsubmit">Submit</button>
  </div>
  <h1 class="top" id="top">   Topics</h1>
  <div id="data1"></div>

  <script>
      if(sessionStorage.getItem("role")!="student"&&sessionStorage.getItem("role")!="teacher")
      window.history.back()
      sessionStorage.removeItem("topic")
      function store(id){
          sessionStorage.setItem("topic",id);
      }
      const role=sessionStorage.getItem("role");
      let sclass=0;
      if(role=="teacher")
      sclass=sessionStorage.getItem("identity");
    fetch(`http://localhost:3000/discussion/fetchtopics`, {
        method: "POST",
        body: JSON.stringify({
          token:sessionStorage.getItem("token"),
          role,
          sclass
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
            let htmlCode=``;
            const result=response.data;
            if(result.length==0)
            {
              document.querySelector("#top").innerHTML="NO TOPIC"
             let  htmlCode =
        `
        <div class="card1 empty" style="width: 18rem;">
            <img class="card-img-top img-fluid thumbnailImage" src="/img/empty.png" alt="">
        </div>
  `;
  const container=document.querySelector("#data1")
            container.innerHTML=htmlCode;
            }
            else{
            for(let c=0;c<result.length;c++) {
      htmlCode =
        htmlCode +
        `
        <li class="row dis">
                <a href="posts.html" onclick='store("${result[c].id}")'>
                    <h4 class="title">
                     ${result[c].title}
                    </h4>
                    <h6 class="title">
                        ${result[c].description}
                    </h6>
                    <div class="bottom">
                        <p class="timestamp create">
                            Author: ${result[c].author}
                        </p>
                        <p class="comment-count">
                            Created at: ${result[c].created_at}
                        </p>
                    </div>
                </a>
        </li>
  `;
    }
    const cards = document.querySelector("#data1");
    cards.innerHTML=htmlCode
            }
        })
      function call(){
        if(!document.querySelector("#title").value)
        {
            alert("Enter Title");
            return;
        }
        fetch(`http://localhost:3000/discussion/submittopic`, {
        method: "POST",
        body: JSON.stringify({
          title:document.querySelector("#title").value.replace(/'/g,''),
          description:document.querySelector("#description").value.replace(/'/g,''),
          token:sessionStorage.getItem("token"),
          role,
          sclass:sessionStorage.getItem("identity")
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
            console.log(response)
});
    
          alert("Topic Submitted");
          window.location.href = "/discussion.html";
      }
  </script>

</body>

</html>
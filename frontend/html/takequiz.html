<!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
---- Include the above in your HEAD tag -------- -->

<!DOCTYPE html>
<html>

<head>
  <title>Home Page</title>
  <!--Made with love by Mutiullah Samim -->

  <!--Bootsrap 4 CDN-->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  <!--Fontawesome CDN-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
    integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

  <!--Custom styles-->
  <link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>
  <ul>
    <form action="/logout.html">
      <input type="submit" class="logout" value="Logout" />
    </form>
  </ul>
  <h1 id="hometext" class="hometext"></h1>
  <div class="row justify-content-center" id="data">
  </div>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->

  <script>
    if(sessionStorage.getItem("role")!="student")
    window.history.back()
      let total=0;
      const token=sessionStorage.getItem("token")
     const subject=sessionStorage.getItem("identity");
     const quizname=sessionStorage.getItem("quizname");
      function call(){
          let result={};
         
            for(let c=1;c<=total;c++){
                let rname="r"+c;
                var rates = document.getElementsByName(rname);
                for(var i = 0; i < rates.length; i++){
            if(rates[i].checked){
        {
            result[c]=i+1;
            break;
        }
    }
}
fetch(`http://localhost:3000/signin/quizresult`, {
        method: "POST",
        body: JSON.stringify({
          token,
          subject,
          quizname,
          result
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
         let htmlcode=`<div class="stext" >
          Your score is- ${response.result} out of ${total}
        </div>`;
          htmlcode=htmlcode+`
        <div class="card1 sc" style="width: 18rem;">
            <img class="card-img-top img-fluid thumbnailImage"  src="/img/yay.png" alt="">
        </div>
  `
            document.querySelector("#data").innerHTML=htmlcode;
            })
            
    }
}

     
     fetch(`http://localhost:3000/signin/takequiz`, {
        method: "POST",
        body: JSON.stringify({
          token,
          subject,
          quizname
        }),
        headers: {
          "Content-type": "application/json; charset=UTF-8",
          'Accept': 'application/json'
        }
      })
        .then(response => {
            console.log("hey")
          return response.json()
        })
        .then(response => {
            let htmlCode = ``;
           let  result=response.data;
           let count=result.count;
           total=count;
           let obj=result.quiz;
            for(let c=1;c<=count;c++) {
                let rname="r"+c;
            htmlCode =
        htmlCode +
        `
        <div >
        <div class="takequiz">
            <div >
              <h6>Q${c}: ${obj[c].ques}</h6>
            </div>
            <form>
            <div class="rtake">
             <label class="radio-inline" >
             <input type="radio" name="${rname}" id="${rname}"  class="takeoption">${obj[c].o1}
              </label>
            </div>
              <div class="rtake">
              <label class="radio-inline">
               <input type="radio" name="${rname}" id="${rname}" class="takeoption" >${obj[c].o2}
              </label>
            </div>
              <div class="rtake">
             <label class="radio-inline">
            <input type="radio" name="${rname}" id="${rname}" class="takeoption" >${obj[c].o3}
            </label>
        </div>
            <div class="rtake">
            <label class="radio-inline">
            <input type="radio" name="${rname}" id="${rname}" class="takeoption" >${obj[c].o4}
            </label>
        </div>
            </form>
        </div>
        </div >
  `;
      // uncomment the line below to see the output in the browser console.
      // console.log(htmlCode);
    }
    htmlCode =htmlCode+
        `
        <button type="Submit" class="qsubmit" onclick='call()' >Submit</button>
  `;
    // currently, we have out html code showing in the browser console, we need to send it to our html file and render it there.
    // here we define out the cards we want to be rendered to the DOM.

    // ".all-elephant-cards" is the class of the empty div back in our index.html. We want to render the cards from our JS inside that div.
    // we are simply saying, "let elephantCards be = to that div", to target that div, we reference the class we gave to it.
    const cards = document.querySelector("#data");
    console.log(htmlCode)

    // here's how we do the render;
    // since elephantCards is now = to that div, we now say let the inside of that div take in our htmlCode variable that holds our html codes.
    cards.innerHTML = htmlCode;
            
});

    // to get each single elephant object from the array and use them to build out html string, we need to open up our array, and we do that using forEach method. The forEach method, finds each item(object) in the array and returns them, this means we get 4 items that are objects back.
      // uncomment the line below, to see each of the 4 objects rendered in the console.
      //console.log(singleElephantObjects);

      // we take our previous empty htmlCode variable and add our html codes to it.

      // because the forEach method returns objects, we can then use the dot notation to reference children of the object, e.g, elephant.title;
      
  </script>

</body>

</html>
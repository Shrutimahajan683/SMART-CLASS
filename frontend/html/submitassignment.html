<!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
---- Include the above in your HEAD tag -------- -->

<!DOCTYPE html>
<html>

<head>
    <title>Quiz Page</title>
    <!--Made with love by Mutiullah Samim -->

    <!--Bootsrap 4 CDN-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!--Fontawesome CDN-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
        integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!--Custom styles-->
    <link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>
    <ul>
        <form action="/logout.html">
            <input type="submit" class="logout" value="Logout" />
        </form>
    </ul>
    <h1 id="hometext" class="hometext"></h1>
  <div  id="data">
  </div>
    <script>
         const id=sessionStorage.getItem("assignment");
        fetch(`http://localhost:3000/anotherfeature/submitassignment`, {
  method: "POST",
  body: JSON.stringify({
    id
  }),
  headers: {
    "Content-type": "application/json; charset=UTF-8",
    'Accept': 'application/json'
  }
})
  .then(response => {
    return response.json()
  })
  .then(response => {
      console.log(response);
      const result=response.data;
      let htmlCode=``;
      htmlCode =
        htmlCode +
        
        `
                <div class="row assiassi justify-content-center">
                <h6 class="name">Assignment- ${result[0].assignmentname}</h6>
                <a href="${result[0].filepath}" class="role_btn">Assignment</a>
                </div>
              `;
    htmlCode=htmlCode+ `<div class="assicontainer">
        <h1>Upload Your File</h1>
        <form id='form'>
            <div class="input-group">
                <label for='name'>File Name</label>
                <input name='name' id='name' placeholder="Enter your name" />
            </div>
            <div class="input-group">
                <label for='files'>Select files(only pdf)</label>
                <input id='files' type="file" multiple accept="application/pdf">
            </div>
            <button class="submit-btn"  value="${result[0].id}" type='submit' id="upload">Upload</button>
        </form>
    </div>
`
    
    const cards = document.querySelector("#data");
    console.log(htmlCode)

    cards.innerHTML = htmlCode;
    const form = document.getElementById("form");

form.addEventListener("submit", submitForm);

function submitForm(e) {
    e.preventDefault();
    const name = document.getElementById("name");
    const files = document.getElementById("files");
    const id=document.getElementById("upload").value;
    console.log(id);
    const formData = new FormData();
    formData.append("name", name.value);
        for(let i =0; i < files.files.length; i++) {
            formData.append("files", files.files[i]);
    }
    fetch(`http://localhost:3000/feature/uploadassignment`, {
        method: 'post',
        body: formData,
        headers: {
    'Accept': 'application/json'
  }
    })
    .then(response => {
        return response.json()
      })
      .then(response => {
        const filename=response.data.filename
        const file=document.querySelector("#name").value;
         console.log(filename)
          fetch(`http://localhost:3000/anotherfeature/submission`, {
         method: "POST",
         body: JSON.stringify({
        id,
        token:sessionStorage.getItem("token"),
        path:filename,
        assignmentname:file,
        }),
  headers: {
    "Content-type": "application/json; charset=UTF-8",
    'Accept': 'application/json'
  }
})
  .then(response => {
    return response.json()
  })
  .then(response => {
      console.log(response)
      fetch(`http://localhost:3000/image/${filename}`, {
          })
          .catch((err)=>console.log(err))
  });
        })
      
        // .catch((err) => ("Error occured", err));
        alert("file uploaded")
        window.location.href = "/submitassignment.html";
}

  });
    </script>
    
</body>

</html>